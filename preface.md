# 前言

> “代码更像是你所说的指导方针，而不是实际的规则。”

在拥挤的现代编程语言领域，Rust 与众不同。Rust 提供了编译的速度 语言、非垃圾回收语言的效率以及函数式语言的类型安全性 以及内存安全问题的独特解决方案。因此，Rust 经常被评为最受欢迎的 编程语言[^rust-popularity]。

Rust 类型系统的强度和一致性意味着，如果一个 Rust 程序编译，就已经有一个像样的 它可能会起作用——这种现象以前只在学术性更强、更易于理解的语言中观察到 比如哈斯克尔。如果 Rust 程序编译，它也可以安全地工作。

不过，这种安全性（包括类型安全和内存安全）确实是有代价的。尽管质量在基本文档中，Rust 以陡峭的入口而闻名，新手必须通过与借用检查器作斗争的启动仪式，重新设计他们的数据结构，并被一生所迷惑。编译的 Rust 程序可能很有可能在第一次工作，但很难让它编译是真实的——即使 Rust 编译器提供了非常有用的错误诊断。

## 本书面向的读者

这本书试图帮助程序员在这些他们挣扎的领域，即使他们已经具有像 C++ 这样的现有编译语言的经验。因此，与其他 Effective 书籍一样，这本书旨在成为 Rust 新手的第二本所需书籍，在他们已经在其他地方遇到基础知识之后 —— 例如，在《[Rust 编程语言](https://doc.rust-lang.org/book/)》（Steve Klabnik和Carol Nichols，No Starch Press）或《[Rust 程序设计](https://www.oreilly.com/library/view/programming-rust-2nd/9781492052586/)》（Jim Blandy等，O'Reilly）中。

然而，Rust 的安全性导致这里的条目有一些不同的侧重点，特别是与 Scott Meyers 的原始 Effective C++ 系列相比。C++ 语言充满了陷阱，所以 Effective C++ 专注于避免这些陷阱的一组建议，这些建议基于在 C++ 中创建软件的实际经验。重要的是，它包含的是指导原则而不是规则，因为指导原则有例外 —— 提供指导原则的详细理由允许读者自行决定他们的特定情况是否值得违反规则。

在这里，提供建议及其原因的风格被保留了下来。但是，由于 Rust 几乎没有陷阱，这里的条目更多地集中在 Rust 引入的概念上。许多条目的标题像“理解…”和“熟悉自己了解…”，并帮助在编写流畅、地道的 Rust 代码的旅程中。

Rust 的安全性也导致完全没有标题为“永远不要…”的条目。如果你真的不应该做某事，编译器通常会阻止你这样做。

## Rust版本

文本是为 2018 版 Rust 编写的， 使用稳定的工具链。Rust 的向后兼容性承诺意味着任何更高版本的 Rust，包括 2021 版本，仍将支持为 2018 版，即使更高版本引入了重大更改。Rust 现在也足够稳定，以至于 2018 年版和 2021 年版之间的差异很小;书中的任何代码都不需要修改才能成为 2021 年版 符合（但第 19 项包括一个例外，其中更高版本的 Rust 允许以前没有的新行为 可能）。

这里的项目没有涵盖 Rust 异步功能的任何方面，因为 这涉及到更高级的概念和不太稳定的工具链支持——已经有足够的基础来覆盖 使用同步 Rust。也许将来会出现有效的异步 Rust......

用于代码片段和错误消息的具体版本为 1.70。代码片段是 不太可能需要对更高版本进行更改，但错误消息可能因特定编译器版本而异。 文本中包含的错误消息也经过手动编辑，以适应本书的宽度限制 但由编译器生成。rustc

该文本有许多引用和比较其他静态类型语言，如 Java、Go 和 C++， 帮助具有这些语言经验的读者定位自己。（C++可能是最接近的等效语言， 特别是当 C++11 的移动语义发挥作用时。

## 本书导读

构成本书的项目分为六章：

第 1 章 — 类型：围绕 Rust 核心类型系统的建议
第 2 章 — 特征：使用 Rust 特征的建议
第 3 章 — 概念：构成 Rust 设计的核心思想
第 4 章 — 依赖关系：使用 Rust 软件包生态系统的建议
第 5 章 — 工具：通过超越 Rust 编译器来改进代码库的建议
第 6 章 — 超越标准 Rust：关于何时必须超越 Rust 标准工作的建议， 安全环境
虽然“概念”一章可以说比“类型”和“特征”一章更基础，但它是故意的 放在书的后面，以便从头到尾阅读的读者可以先建立一些信心。

## 本书中使用的约定

本书使用了以下排版约定：

斜体：表示新术语、URL、电子邮件地址、文件名和文件扩展名。
固定宽度：用于程序列表，以及在段落中引用程序元素，如变量或函数名、数据库、数据类型、环境变量、语句和关键字。
以下标记用于标识以某种方式不正确的代码。

以下标记用于标识以某种方式不正确的代码：


[^rust-popularity]: https://survey.stackoverflow.co/2022#most-loved-dreaded-and-wanted-language-love-dread
